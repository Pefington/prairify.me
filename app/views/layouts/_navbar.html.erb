<header class="w-full relative bg-soft text-inverse">
  <nav x-data="{ isOpen: false }" class="relative p-4 lg:flex ">
    <div class="flex items-center justify-around w-full">

      <div class="w-16">
        <%= link_to root_path do %>
          <%= vite_image_tag 'images/logo.png' %>
        <% end %>
      </div>

      <div class="text-xl ">
        <%= link_to "Prairify.me", root_path, class: "font-FjallaOne text-2xl sm:text-3xl lg:text-4xl link" %>
      </div>

      <%# Large Links %>
      <div class="hidden lg:flex items-start justify-center xl:space-x-8">
        <%= link_to t('homebtn'), root_path, class: "link text-xl drop-shadow-md" %>
        <%= link_to t('teambtn'), team_path, class: "link text-xl drop-shadow-md" %>
        <%= link_to t('aboutbtn'), about_path, class: "link text-xl drop-shadow-md" %>
        <%= link_to t('contactbtn'), contact_path, class: "link text-xl drop-shadow-md" %>
        <% if user_signed_in? %>
          <%= link_to "Projects", projects_path, class: "link text-xl drop-shadow-md" %>
        <% end %>
        <section class="hidden">
          <% if current_user %>
            <%= link_to "Admin", admin_root_path, class: "btn btn-vivid mb-4 w-3/4" if current_user.admin? %>
            <%= link_to t('myprofilebtn'), profile_path, class: "btn btn-vivid mb-4 w-3/4" %>
            <%= link_to t('favoritebtn'), favourites_path, class: "btn btn-vivid mb-4 w-3/4" %>
            <%= button_to t('signoutbtn'), destroy_user_session_path, method: :delete, class: "btn btn-vivid" %>
          <% else %>
            <%= link_to t('signinbtn'), user_session_path, class: "btn btn-vivid mb-4 w-3/4" %>
            <%= link_to t('registerbtn'), new_user_registration_path, method: :get, class: "btn btn-vivid w-3/4" %>
          <% end %>
        </section>
      </div>
      <section class="hidden lg:flex items-center">
        <%= button_to search_index_path, method: :get, params: {search: 'geoloc'}, class: "link p-1" do %>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-9 h-9 text-inverse hover:text-vivid"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"
            />
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"
            />
          </svg>
        <% end %>
        <%= render "shared/search_bar" %>

        <%# Profile Button %>
        <div x-data="{largeOpen: true}" class="relative">
          <button
            x-on:click="largeOpen = !largeOpen"
            type="button"
            aria-label="toggle profile dropdown"
            class=" link"
          >
            <i class="fa-solid fa-user fa-2x"></i>

          </button>

          <%# Profile Items %>
          <div
            x-cloak
            x-show="largeOpen"
            class="
              z-10
              absolute
              right-0
              mt-6
              w-48
              origin-top-right
              rounded-md
              py-1
              shadow-lg
              ring-1
              ring-opacity-5
            "
            role="menu"
            aria-orientation="vertical"
            aria-labelledby="user-menu-button"
            tabindex="-1"
          >
            <% if @profile %>
              <% if @profile.username %>
                <h3 class="mx-2 lg:hidden "><%= @profile.username %></h3>
              <% else %>
                <h3 class="mx-2 lg:hidden "><%= @profile.email %></h3>
              <% end %>
            <% end %>
            <% if current_user %>
              <%= link_to "Admin", admin_root_path, class: "block px-4 py-2 text-sm" if current_user.admin? %>
              <%= link_to t('myprofilebtn'), profile_path, class: "block px-4 py-2 text-sm  rounded-md" %>
              <%= link_to t('favoritebtn'), favourites_path, class: "block px-4 py-2 text-sm  rounded-md" %>
              <%= button_to t('signoutbtn'), destroy_user_session_path, method: :delete, class: "block px-4 py-2 text-sm  rounded-md" %>
            <% else %>
              <%= link_to t('signinbtn'), user_session_path, class: "block px-4 py-2 text-sm  rounded-md" %>
              <%= link_to t('registerbtn'), new_user_registration_path, method: :get, class: "block px-4 py-2 text-sm  rounded-md" %>
            <% end %>
          </div>
        </div>
      </section>

      <%# Hamburger Button %>
      <div class="flex lg:hidden" x-cloak @keyup.space="isOpen = !isOpen">
        <button type="button" class="link" aria-label="toggle menu">
          <svg
            @click="isOpen = true"
            x-show="!isOpen"
            xmlns="http://www.w3.org/2000/svg"
            class="w-6 h-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 8h16M4 16h16"/>
          </svg>
          <svg
            x-show="isOpen"
            xmlns="http://www.w3.org/2000/svg"
            class="w-6 h-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
    </div>

    <%# Menu Items %>
    <div
      x-cloak
      :class="[isOpen ? 'translate-x-0 opacity-100 ' : 'opacity-0 -translate-x-full']"
      class="
        flex
        flex-col
        items-center
        absolute
        inset-x-0
        z-20
        w-full
        mt-4
        p-8
        bg-soft/90
      "
    >
      <div
        @mousedown.outside="isOpen = false"
        class="flex flex-col max-w-sm sm:justify-center"
      >
        <%= link_to t('homebtn'), root_path, class: "btn btn-middle mb-4" %>
        <%= link_to t('teambtn'), team_path, class: "btn btn-middle mb-4" %>
        <%= link_to t('aboutbtn'), about_path, class: "btn btn-middle mb-4" %>
        <%= link_to t('contactbtn'), contact_path, class: "btn btn-middle" %>
        <% if user_signed_in? %>
          <%= link_to "Projects", projects_path, class: "btn btn-middle mt-4" %>
        <% end %>
        <section class="flex justify-end items-center my-8 w-full">
          <%= button_to search_index_path, method: :get, params: {search: 'geoloc'}, class: "mr-4 w-12 text-inverse hover:text-vivid focus:text-inverse focus:bg-vivid rounded-md p-1 hover:font-bold" do %>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"
              />
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"
              />
            </svg>
          <% end %>
          <%= render "shared/search_bar" %>
        </section>
        <section class="flex flex-col items-end">
          <% if current_user %>
            <%= link_to "Admin", admin_root_path, class: "btn btn-middle mb-4 w-3/4" if current_user.admin? %>
            <%= link_to t('myprofilebtn'), profile_path, class: "btn btn-middle mb-4 w-3/4" %>
            <%= link_to t('favoritebtn'), favourites_path, class: "btn btn-middle mb-4 w-3/4" %>
            <%= button_to t('signoutbtn'), destroy_user_session_path, method: :delete, class: "btn btn-middle" %>
          <% else %>
            <%= link_to t('signinbtn'), user_session_path, class: "btn btn-middle mb-4 w-3/4" %>
            <%= link_to t('registerbtn'), new_user_registration_path, method: :get, class: "btn btn-middle w-3/4" %>
          <% end %>
        </section>
      </div>

    </div>

  </nav>
</header>
